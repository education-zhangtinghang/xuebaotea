<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>个人资料</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<script type="text/javascript" src="../js/zoom/flexible.js" ></script>
		<style>
			.list_ul{
				
			}
			.list_ul li{
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0.5rem 5%;
				background-color: #FEFEFE;
				border-bottom: 1px solid #F0F0F0;
				font-size: 0.416666rem;
				color: #555555;
			}
			.list_ul li:active{
				background-color: rgb(240,240,240);
			}
			.right_box{
				display: flex;
				justify-content: center;
				align-content: center;
			}
			.avatar_box{
				display: block;
				width: 1.694444rem;
				height: 1.694444rem;
				border-radius:45px;
				overflow: hidden;
			}
			.avatar_box img{
				width: 100%;
				height: 100%;
			}
			
			.right_btn{
				display: flex;
				align-items: center;
				color: #888888;
				font-size: 0.388888rem;
			}
			.right_btn img{
				width: 0.194444rem;
				height: 0.333333rem;
				margin-left: 0.222222rem;
			}
		</style>
	</head>

	<body>
		<div class="content" id="msg-content">
			<div class="list_box">
				<ul class="list_ul">
					<li id="my_picture"><span>头像</span><div class="right_box"><span class="avatar_box"><img src="" v-lazy="imgUrl+teacherDetail.teacherImage" /></span></div></li>
					<li><span>姓名</span><span class="right_btn" v-text="teacherDetail.name"></span></li>
					<li><span>性别</span><span class="right_btn" v-text="teacherDetail.gender"></span></li>
					<li><span>电话</span><span class="right_btn" v-text="teacherDetail.mobilephone"></span></li>
					<li data-type = "1"><span>学校</span><span class="right_btn"><span v-text="teacherDetail.teacherSchool"></span> <img src="../images/myself/next_content.png" /></span></li>
					<li data-type = "2"><span>区域</span><span class="right_btn"><span>{{teacherDetail.teacherArea | teacherArea}}</span> <img src="../images/myself/next_content.png" /></span></li>
				</ul>
			</div>
		</div>
		<div class="mui-cropper-modal mui-modal">
			<div class="cropper-image-container">
				<img id="image" src="" />
			</div>
			<div class="cropper-btn-group">
				<span class="cropper-cancel">取消</span>
				<span class="cropper-ok">裁剪</span>
			</div>
		</div>
		<!--取出加密值-->
        <input type="text" style="visibility:hidden" id="getPassword" value="" />
		<script src="../js/mui.min.js"></script>
		<script type="text/javascript" src="../js/config.js"></script>
		<script type="text/javascript" src="../js/hmac-sha1.js" ></script>
		<script type="text/javascript" src="../js/login_config.js" ></script>
		<script type="text/javascript" src="../js/cropper.min.js" ></script>
		<script type="text/javascript" src="../js/mui.cropper.js" ></script>
		<script type="text/javascript" src="../js/vue.min.js" ></script>
		<script type="text/javascript" src="../js/vue-lazyload.js" ></script>
		<script type="text/javascript" src="../js/ajax.js" ></script>
		<script type="text/javascript" src="../js/updateSelf.js" ></script>
		<script type="text/javascript">
			mui.init();
			mui.plusReady(function () {
				//监听返回
			    listenReturn();
			    listenReturnRight('修改');
			    var self = plus.webview.currentWebview();
			    var view = self.getTitleNView();
			    //参数传递	     
			    var teacherData = self.teacherData ||'';
			    var fileArr = [];
			    var dataObj = {};
			    if(teacherData == ''||null){
			    	plus.nativeUI.toast('请先登录！');
			    }
			    console.log(JSON.stringify(teacherData))
			     //点击提交
			    view.addEventListener("click", function(e) {
					if(screen.width - e.clientX <= 60){
						dataObj.school = teacherData.teacherSchool;
						dataObj.city = teacherData.teacherArea;
						sendFormData(dataObj,fileArr);
					}
				}, false);
				
			    //渲染初始信息
			    vm.teacherDetail = teacherData;
			    vm.imgUrl = ajaxUrl;
			    
			    
			    //接收学校参数
				window.addEventListener('school',function(event){
					var value = event.detail.value;
					teacherData.teacherSchool = value;
		    		vm.teacherDetail = teacherData;
				});
			    //接收区域参数
				window.addEventListener('address',function(event){
					var value = event.detail.value;				
					teacherData.teacherArea = value;
		    		vm.teacherDetail = teacherData;
				});
				
			    			    
			    //存放头像图片地址
			    var imgfile=[];
				//获取照片信息
//				document.getElementById("my_picture").addEventListener('tap',function(){
//					var btnArray = [{
//						title: "拍照"
//					}, {
//						title: "从相册选择"
//					}];
//					plus.nativeUI.actionSheet({
//						title: "选择照片",
//						cancel: "取消",
//						buttons: btnArray
//					}, function(e) {
//						var index = e.index;
//						switch (index) {
//							case 0:
//								break;
//							case 1:
//								var cmr = plus.camera.getCamera();
//								cmr.captureImage(function(path) {
//									var lfs = "file://" + plus.io.convertLocalFileSystemURL(path);
//									addFile(lfs);
//								}, function(err) {});
//							break;
//							case 2:
//								plus.gallery.pick(function(path) {
//									addFile(path);
//								}, function(err) {}, {filter:"image",system:false});
//							break;
//						}
//					});
//				})
				
				var addFile = function(path) {
					imgfile.push({path:path});
					console.log(JSON.stringify(imgfile))
					//渲染图片
					console.log(imgfile[0].path)
					vm.teacherDetail.teacherImage = imgfile[0].path;
				}
			    
			    mui('.list_ul').on('tap','li',function(){
			    	var type = this.getAttribute('data-type');
			    	switch (type){
			    		case '1':
			    			openView.nativeView('self_change.html', 'self_change', '学校',{'eg':vm.teacherDetail.teacherSchool});
			    			break;
			    		case '2':
			    			openView.nativeView('localtion.html', 'localtionArea', '区域',{'eg':vm.teacherDetail.teacherArea,'type':type});
			    			break;
			    		default:
			    			break;
			    	}
			    })
			    
			})
			
			Vue.filter('teacherArea',function(value){ 
				if(value){
					switch (value){
						case 1:
							return '成都市';
							break;
						case 2:
							return '新增城市';
							break;
						default:
							break;
					}
				}else{
					return '';
				}
			})
			Vue.use(VueLazyload, {  
			  preLoad: 1.3,  
			  error: '../images/status/failed_trend.png',  
			  loading: '../images/status/failed_trend.png',  
			  attempt: 3  
			});
			var vm = new Vue({
				el: '#msg-content',
				data: {
					teacherDetail:{},
					imgUrl:''
				}			
			})
		</script>
	</body>

</html>